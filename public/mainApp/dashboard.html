<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Waste Management System</title>
  <!-- <script src="https://cdn.tailwindcss.com"></script> -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">



  <style>
    /* ===== Root Variables ===== */

    :root {
      --bg: white;
      /* slate-900 */
      --card: #111827;
      /* gray-900 */
      --muted: #94a3b8;
      /* slate-400 */
      --accent: #22c55e;
      /* green-500 */
      --accent-2: #06b6d4;
      /* cyan-500 */
      --warn: #ef4444;
      /* red-500 */
      --ring: #3b82f6;
      /* blue-500 */
      --surface: #0b1222;
    }

    /* ===== Global Styles ===== */
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Ubuntu, Helvetica, Arial, sans-serif;
      background: linear-gradient(180deg, var(--bg), #060b18);
      color: #404858;
    }

    a {
      color: inherit;
    }

    /* ===== App Layout ===== */
    .app {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* ===== Header & Navigation ===== */
    header {
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: saturate(180%) blur(8px);
      background: rgba(15, 23, 42, .8);
      border-bottom: 1px solid #1f2937;
    }

    .nav {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
    }

    .brand {
      font-weight: 800;
      letter-spacing: .3px;
      color: white;
    }

    .grow {
      flex: 1;
    }

    .chip {
      font-size: 12px;
      padding: 4px 8px;
      border: 1px solid #1f2937;
      border-radius: 999px;
      color: #cbd5e1;
    }

    /* Hamburger menu (hidden by default) */
    .hamburger {
      display: none;
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
    }

    /* ===== Buttons ===== */
    .btn {
      background: linear-gradient(180deg, #1e293b, #0b1222);
      border: 1px solid #1f2937;
      color: #e5e7eb;
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      transition: .2s;
      box-shadow: 0 1px 0 rgba(255, 255, 255, .06) inset;
    }

    .btn:hover {
      transform: translateY(-1px);
      border-color: #334155;
    }

    .btn.outline {
      background: transparent;
    }

    .btn.warn {
      background: linear-gradient(180deg, #ef4444, #b91c1c);
      border-color: #7f1d1d;
    }

    /* ===== Layout Grid ===== */
    .layout {
      display: grid;
      grid-template-columns: 260px 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
      flex: 1;
    }

    /* ===== Sidebar ===== */
    aside {
      background: linear-gradient(180deg, #0b1222, #0a0f1e);
      border: 1px solid #111827;
      border-radius: 16px;
      padding: 12px;
      position: sticky;
      top: 68px;
      height: calc(100vh - 84px);
      overflow: auto;
      transition: transform 0.3s ease-in-out;
    }

    .section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .section h4 {
      margin: 6px 8px 2px;
      font-size: 13px;
      font-weight: 700;
      color: #a5b4fc;
      text-transform: uppercase;
      letter-spacing: .08em;
    }

    /* ===== Sidebar Menu ===== */
    .menu {
      display: flex;
      flex-direction: column;
    }

    .menu button {
      all: unset;
      padding: 10px 12px;
      border-radius: 10px;
      cursor: pointer;
      color: #cbd5e1;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid transparent;
    }

    .menu button:hover {
      background: #0a1224;
      border-color: #0b2348;
    }

    .menu button.active {
      background: linear-gradient(180deg, #0e223d, #0a162a);
      border-color: #1e3a8a;
    }

    /* ===== Main Content ===== */
    main {
      min-height: 60vh;
    }

    .panel {
      background: linear-gradient(180deg, var(--card), #0a101b);
      height: 91.2vh;
      border: 1px solid #111827;
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, .25);
      overflow-y: auto;
    }

    .panel {

      background-image: url("../mainApp/bgimage.png");
      /* Specify the image file path */
      background-repeat: no-repeat;
      /* Prevents the image from repeating */
      background-position: center center;
      /* Centers the image */
      background-size: cover;
      /* Scales the image to cover the entire element */
      /* Add other background properties as needed, e.g., background-attachment: fixed; */

    }

    .panel h2 {
      margin: 0 0 8px 0;
      color: rgb(15, 15, 15);
    }

    .muted {
      color: var(--muted);
      margin-top: 0;
    }

    .ubi {
      background: linear-gradient(180deg, var(--card), #0a101b);
      height: auto;
      border: 1px solid #111827;
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, .25);
    }

    /* ===== Cards & Grids ===== */
    .card {
      background: linear-gradient(180deg, #0e1627, #0b121f);
      border: 1px solid #0b1628;
      border-radius: 14px;
      padding: 12px;
      color: #e5e7eb;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .subgrid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
    }

    /* ===== Form Elements ===== */
    .row {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .input,
    .select,
    .textarea {
      background: #0b1222;
      border: 1px solid #1f2937;
      border-radius: 10px;
      color: #e5e7eb;
      padding: 10px 12px;
      width: 100%;
    }

    .select {
      appearance: none;
    }

    label {
      font-size: 12px;
      color: #94a3b8;
      display: block;
      margin-bottom: 4px;
    }

    /* ===== Tables ===== */
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 8px;
    }

    th,
    td {
      text-align: left;
      font-size: 14px;
      padding: 10px 12px;
      color: #e5e7eb;
    }

    thead th {
      color: #93c5fd;
      font-weight: 700;
      border-bottom: 1px solid #1f2937;
    }

    tbody tr {
      background: linear-gradient(180deg, #0b1222, #0a0f1e);
      border: 1px solid #111827;
    }

    tbody tr td:first-child {
      border-top-left-radius: 10px;
      border-bottom-left-radius: 10px;
    }

    tbody tr td:last-child {
      border-top-right-radius: 10px;
      border-bottom-right-radius: 10px;
    }

    /*order section*/

    /* Container */
    .booking-container {
      max-width: 900px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.6);
      padding: 2.5rem;
      border-radius: 1rem;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    /* Title */
    .booking-container h2 {
      font-size: 2rem;
      font-weight: bold;
      text-align: center;
      margin-bottom: 2rem;
      color: #1f2937;
      /* gray-900 */
    }

    /* Form Grid */
    .booking-form {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    @media (min-width: 768px) {
      .booking-form {
        grid-template-columns: 1fr 1fr;
      }

      .form-submit {
        grid-column: span 2;
      }
    }

    /* Form Group */
    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #1f2937;
      /* gray-900 */
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      background: #374151;
      /* gray-700 */
      border: 1px solid #4b5563;
      /* gray-600 */
      color: #e5e7eb;
      /* gray-200 */
      font-size: 1rem;
      outline: none;
      transition: border 0.2s, box-shadow 0.2s;
    }

    .form-group input:focus,
    .form-group select:focus {
      border-color: #3b82f6;
      /* blue-500 */
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
    }

    /* Small Text */
    .form-group small {
      display: block;
      color: #374151;
      font-size: 0.85rem;
      margin-top: 0.25rem;
    }

    /* Button */
    .form-submit button {
      width: 100%;
      background: #2563eb;
      /* blue-600 */
      color: #fff;
      font-weight: 600;
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.2s;
    }

    .form-submit button:hover {
      background: #1d4ed8;
      /* blue-700 */
    }


    /* ===== KPI Cards ===== */
    .kpi {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }

    .kpi .card {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .kpi .value {
      font-size: 22px;
      font-weight: 800;
      color: white;
    }

    /* ===== Tags & Empty States ===== */
    .tag {
      font-size: 11px;
      border: 1px solid #1f2937;
      border-radius: 999px;
      padding: 2px 8px;
      color: #cbd5e1;
    }

    .empty {
      padding: 20px;
      color: #94a3b8;
      text-align: center;
    }

    /* ===== Utility Classes ===== */
    .hidden {
      display: none !important;
    }

    /* ===== Responsive ===== */
    @media (max-width: 1024px) {
      .layout {
        grid-template-columns: 1fr;
        padding: 10px;
      }

      aside {
        position: fixed;
        top: 60px;
        left: 0;
        height: calc(100vh - 60px);
        width: 260px;
        z-index: 90;
        transform: translateX(-100%);
        border-radius: 0;
        border-left: none;
        border-top: 1px solid #1f2937;
      }

      aside.active {
        transform: translateX(0);
        box-shadow: 5px 0 15px rgba(0, 0, 0, 0.2);
      }

      .hamburger {
        display: block;
      }

      .panel {
        height: auto;
        min-height: 80vh;
      }

      .kpi {
        grid-template-columns: repeat(2, 1fr);
      }

      .grid-2 {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 540px) {
      .kpi {
        grid-template-columns: 1fr;
      }

      .nav {
        padding: 8px 12px;
      }

      .layout {
        padding: 8px;
      }

      .panel {
        padding: 12px;
      }
    }

    /* Overlay for mobile when sidebar is open */
    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 80;
    }

    .overlay.active {
      display: block;
    }
  </style>


</head>

<body>
  <div class="app" id="app">
    <header>
      <div class="nav">
        <button class="hamburger" id="hamburger">
          <i class="fas fa-bars"></i>
        </button>
        <div class="logo-section" style="display:flex;align-items:center;gap:10px;">
          <img src="../mainApp/logo.png" alt="logo" style="height:32px; width:32px;">

          <span class=" brand">SuchiSankalp</span>
        </div>
        <div class="grow"></div>
        <span id="userName" class="chip"></span>
        <button id="logoutBtn" class="btn outline">Logout</button>
      </div>
    </header>

    <!-- Overlay for mobile -->
    <div class="overlay" id="overlay"></div>

    <!-- MAIN APP LAYOUT -->
    <div id="main" class="layout">
      <aside id="sidebar">
        <div class="section">
          <h4>Dashboard</h4>
          <div class="menu">
            <button data-view="home" class="active">
              <span><i class="fas fa-home"></i> Overview</span>
            </button>
            <button data-view="profile">
              <span><i class="fas fa-user"></i> User Profile</span>
            </button>
            <button data-view="booking">
              <span><i class="fas fa-calendar"></i> Booking</span>

            </button>
            <button data-view="payments">
              <span><i class="fas fa-credit-card"></i> Payments</span>
            </button>
            <button data-view="incentives">
              <span><i class="fas fa-gift"></i> Incentives</span>
            </button>
            <button data-view="collection">
              <span><i class="fas fa-trash"></i> Collection</span>
            </button>
            <button data-view="monitoring">
              <span><i class="fas fa-chart-line"></i> Monitoring</span>
            </button>
            <button data-view="facilities">
              <span><i class="fas fa-map-marker"></i> Facilities</span>
            </button>
            <button data-view="training">
              <span><i class="fas fa-graduation-cap"></i> Training</span>
            </button>
            <button data-view="admin">
              <span><i class="fas fa-cog"></i> Admin</span>
            </button>
          </div>
        </div>
      </aside>

      <main>
        <!-- Overview Panel (others would be similar) -->
        <section id="view-home" class="panel">
          <h2>Overview</h2>
          <p class="muted">Personalized dashboard with quick KPIs</p>
          <div class="kpi">
            <div class="card">
              <div class="label">Upcoming Pickups</div>
              <div class="value" id="kpiUpcoming">2</div>
              <div class="row"><span class="tag" id="kpiNextDate">15 Oct 2023</span></div>
            </div>
            <div class="card">
              <div class="label">Rewards</div>
              <div class="value" id="kpiRewards">120</div>
              <div class="row"><span class="tag">Lifetime Points</span></div>
            </div>
            <div class="card">
              <div class="label">Compliance</div>
              <div class="value" id="kpiCompliance">100%</div>
              <div class="row"><span class="tag" id="kpiFines">No fines</span></div>
            </div>
            <div class="card">
              <div class="label">Transactions</div>
              <div class="value" id="kpiTx">5</div>
              <div class="row"><span class="tag">Last 30 days</span></div>
            </div>
          </div>

          <div style="margin-top: 20px;">
            <h3>Recent Activity</h3>
            <div class="card">
              <div class="row">
                <i class="fas fa-check-circle" style="color: var(--accent);"></i>
                <span>Pickup completed - Plastic (2.5 kg)</span>
                <span class="tag">12 Oct 2023</span>
              </div>
              <div class="row">
                <i class="fas fa-check-circle" style="color: var(--accent);"></i>
                <span>Payment received - â‚¹200</span>
                <span class="tag">10 Oct 2023</span>
              </div>
              <div class="row">
                <i class="fas fa-check-circle" style="color: var(--accent);"></i>
                <span>New booking confirmed</span>
                <span class="tag">08 Oct 2023</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Other sections would go here (simplified for this example) -->
        <section id="view-profile" class="panel hidden">
          <h2>Profile Details</h2>
          <div class="grid-2">
            <div class="card">
              <h3>User Information</h3>
              <div id="profileBox">
                <div class="row">
                  <div class="tag">Name</div>
                  <div id="profileUserName"></div>
                </div>
                <div class="row">
                  <div class="tag">Email</div>
                  <div id="email"></div>
                </div>
                <div class="row">
                  <div class="tag">Address</div>
                  <div>123 Green Street, Eco City</div>
                </div>
                <div class="row">
                  <div class="tag">Member Since</div>
                  <div>Jan 2023</div>
                </div>
              </div>
            </div>
            <div class="card">
              <h3>Account Settings</h3>
              <div class="row">
                <button class="btn">Edit Profile</button>
                <button class="btn">Change Password</button>
              </div>
              <div class="row">
                <button class="btn">Notification Settings</button>
                <button class="btn outline">Download Data</button>
              </div>
            </div>
          </div>
        </section>

        <!-- booking section dilam....yooo -->
        <section id="view-booking" class="panel hidden">
          <div class="booking-container">
            <h2>Book a Service</h2>

            <form class="booking-form">
              <!-- Location -->
              <div class="form-group">
                <label for="location">Location</label>
                <input type="text" id="location" name="location" placeholder="Enter your location" required />
              </div>

              <!-- Date & Time -->
              <div class="form-group">
                <label for="date_time">Date & Time</label>
                <input type="datetime-local" id="date_time" name="date_time" required />
              </div>

              <!-- Waste Category -->
              <div class="form-group">
                <label for="waste_category">Waste Category</label>
                <select id="waste_category" name="waste_category" required>
                  <option value="">Select a category</option>
                  <option value="organic">Organic</option>
                  <option value="plastic">Plastic</option>
                  <option value="metal">Metal</option>
                  <option value="electronic">Electronic</option>
                  <option value="other">Other</option>
                </select>
              </div>

              <!-- Phone Number -->
              <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" name="phone" placeholder="Enter your phone number" pattern="[0-9]{10}"
                  required />
                <small>Format: 10 digits (e.g., 9876543210)</small>
              </div>

              <!-- Submit Button -->
              <div class="form-submit">
                <button type="submit" id="submit_booking">Book Now</button>
              </div>
            </form>
          </div>
        </section>


      </main>
    </div>
  </div>


  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const hamburger = document.getElementById('hamburger');
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('overlay');
      const menuButtons = document.querySelectorAll('.menu button');

      // Toggle sidebar on hamburger click
      hamburger.addEventListener('click', function () {
        sidebar.classList.toggle('active');
        overlay.classList.toggle('active');
      });

      // Close sidebar when clicking on overlay
      overlay.addEventListener('click', function () {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
      });

      // Handle menu clicks
      menuButtons.forEach(button => {
        button.addEventListener('click', function () {
          // Remove active class from all buttons
          menuButtons.forEach(btn => btn.classList.remove('active'));
          // Add active class to clicked button
          this.classList.add('active');

          // Hide all panels
          document.querySelectorAll('main > section').forEach(section => {
            section.classList.add('hidden');
          });

          // Show the selected panel
          const viewId = this.getAttribute('data-view');
          document.getElementById(`view-${viewId}`).classList.remove('hidden');

          // On mobile, close sidebar after selection
          if (window.innerWidth <= 1024) {
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
          }
        });
      });

      // Handle logout button
      const logoutBtn = document.getElementById('logoutBtn')
      logoutBtn.addEventListener('click', async function () {
        logoutBtn.innerHTML = 'leoleo'
        const response = await fetch('http://192.168.29.102:3000/user/logout')
        const result = await response.json()
        return window.location.href = result.redirect
      });





      // Close sidebar if window is resized to desktop size
      window.addEventListener('resize', function () {
        if (window.innerWidth > 1024) {
          sidebar.classList.remove('active');
          overlay.classList.remove('active');
        }
      });
    });


    const userName = document.getElementById('userName')
    const profileUserName = document.getElementById('profileUserName')
    const email = document.getElementById('email')
    // const address = document.getElementById('address')
    // const memberScence = document.getElementById('memberScence')
    //anmar kaj ai khan theke suru
    //fetch all user data
    fetch('http://192.168.29.102:3000/user/userData')
      .then((res) => {
        return res.json()
      })
      .then((data) => {
        // console.log(data);

        userName.innerHTML = data.username
        profileUserName.innerText = data.username
        email.innerText = data.email
       })
      .catch((err) => {
        console.log('error to fetch user detiles' + err);
      })


    //  .then(()=>{})
    //  .catch((error)=>{'error to get data in dashboard_serve_BE'+ error})


    //***********************booking*******************************


    const submit_booking = document.getElementById('submit_booking')
    submit_booking.addEventListener('click', async (e) => {
      e.preventDefault()
      const location = document.getElementById('location')
      const dateAndTime = document.getElementById('date_time')
      const waste_category = document.getElementById('waste_category')
      const phone = document.getElementById('phone')

      const bookingData = {
        location: location.value,
        dateAndTime: dateAndTime.value,
        waste_category: waste_category.value,
        phone: phone.value
      }
      location.value = ""
      dateAndTime.value = ""
      waste_category.value = ""
      phone.value = ""
      // console.log(bookingData);
      try {
        const response = await fetch("http://192.168.29.102:3000/user/dashboard", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(bookingData)
        })
        result = await response.json();

      } catch (error) {
        console.log("error to send booking data" + error);

      }
    })

  </script>
</body>

</html>